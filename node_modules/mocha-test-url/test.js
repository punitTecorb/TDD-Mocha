var testUrl = require('mocha-test-url');

testUrl.setHost('http://localhost:4003');
testUrl.setUrlLogin('/mocha/login');

describe("Init Page Permission", function () {
	before(function() {
		this.timeout(150000);
		return new Promise(function (resolve) {

			/* -------------- Set User -------------- */

			// Guest
			testUrl.addUser('Guest');

			// Admin
			testUrl.addUser('staff1@test.com', '7c4a8d09ca3762af61e59520943dc26494f8941b','Admin');

			// Normal User
			testUrl.addUser('user1@test.com', '7c4a8d09ca3762af61e59520943dc26494f8941b','User');

			resolve(true);
		})

	});

	after(function() {
		testUrl.runTest();
		// testUrl.runList();
	});

	describe("init", function () {
		it(`Setup Path and Permission`, function (done) {

			testUrl.setGroup('Page Permission');

			testUrl.setURLAndCheck(
				'View Page Product',
				'/page',
				'get'
			);

			testUrl.setURLAndCheck(
				'View Page Analytic',
				'/page/setting',
				'get',
				[
					testUrl.checkStatus(100), // Guest
					testUrl.checkStatus(200), // Admin
					testUrl.checkStatus(100), // Normal User
				]
			);

			done();
		});
	});
});
